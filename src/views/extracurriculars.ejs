<%- include("partials/header"); %>

<div class="Extracurriculars">
    <div class="extracurriculars-container">
        <!-- Scholarship Cards Section -->
        <div class="extracurriculars-section" id="extracurricularsContainer">
            
            <!-- Add more cards as needed -->
        </div>

        <!-- Filter Section -->
        <div class="Extracurriculars-Right">
            <div class="filter-section">
                <input type="text" placeholder="Search..." class="search-bar">
                <div class="filters">
                    <label for="type">Interests</label>
                    <select id="type">
                        <option value="all">All</option>
                        <option value="Arts">Arts</option>
                        <option value="Engineering">Engineering</option>
                        <option value="Math">Math</option>
                        <option value="Politics">Politics</option>
                        <option value="Reading / Writing">Reading / Writing</option>
                        <option value="Sports">Sports</option>
                        <option value="History">History</option>
                        <option value="Technology">Technology</option>
                        <option value="Music">Music</option>
                        <option value="Medicine">Medicine</option>

                    </select>
                </div>
                <!-- Information Box -->
            
            </div>
            <div class="info-box-big">
                <div class="info-box">
                    <h2>Extracurriculars How-To:</h2>
                    <ol>
                        <li></li>
                    </ol>
                </div>
            </div>
        </div>

    </div>
</div>


<script>
    let extracurricularsData = []; // Store scholarships data for filtering

    async function loadExtracurriculars() {
        try {
            const response = await fetch('/extracurricular.json');
            universityData = await response.json(); // Save the fetched data
            displayExtracurriculars(extracurricularsData); // Display all scholarships initially
        } catch (error) {
            console.error('Error loading extracurricular:', error);
        }
    }
    // Function to load JSON data
    function displayExtracurriculars(extracurriculars) {
        const container = document.getElementById('extracurricularsContainer');
        container.innerHTML = ''; // Clear previous scholarship cards

        extracurriculars.forEach(extracurricular => {
            const card = document.createElement('div');
            card.classList.add('university-card');

            card.innerHTML = `
                <div class="content">
                    <h3>${extracurricular.title}</h3>
                    <div class="info">
                        <p><span class="req">Description:</span> <span class="req-info">${extracurricular["extracurricular details"]}</span></p>
                    </div>
                </div>
            `;

            container.appendChild(card);
        });
    }

    // Call the function to load scholarships on page load
    // GPA filter function
    function filterExtracurriculars() {
        const typeFilter = document.getElementById('type').value.toLowerCase();
        const stateFilter = document.getElementById('state').value.toLowerCase();
        const acceptanceFilter = document.getElementById('acceptance').value;
        const inCostFilter = document.getElementById('is_cost').value;
        const outCostFilter = document.getElementById('os_cost').value;
        const searchQuery = document.querySelector('.search-bar').value.toLowerCase();

        const filteredUniversities = universityData.filter(university => {
            const matchesType = typeFilter === "all" || university.type.toLowerCase() === typeFilter;
            const matchesState = stateFilter === "all" || university.state.toLowerCase() === stateFilter;

            const acceptanceRate = parseFloat(university.acceptance);
            const matchesAcceptance = 
                acceptanceFilter === "all" ||
                (acceptanceFilter === "below_10" && acceptanceRate < 10) ||
                (acceptanceFilter === "10_20" && acceptanceRate >= 10 && acceptanceRate < 20) ||
                (acceptanceFilter === "20_30" && acceptanceRate >= 20 && acceptanceRate < 30) ||
                (acceptanceFilter === "above_30" && acceptanceRate >= 30);

            const inCost = parseFloat(university.is_cost);
            const matchesInCost = 
                inCostFilter === "all" ||
                (inCostFilter === "below_20000" && inCost < 20000) ||
                (inCostFilter === "20000_40000" && inCost >= 20000 && inCost < 40000) ||
                (inCostFilter === "40000_60000" && inCost >= 40000 && inCost < 60000) ||
                (inCostFilter === "above_60000" && inCost >= 60000);

            const outCost = parseFloat(university.os_cost);
            const matchesOutCost = 
                outCostFilter === "all" ||
                (outCostFilter === "below_20000" && outCost < 20000) ||
                (outCostFilter === "20000_40000" && outCost >= 20000 && outCost < 40000) ||
                (outCostFilter === "40000_60000" && outCost >= 40000 && outCost < 60000) ||
                (outCostFilter === "above_60000" && outCost >= 60000);

            const matchesSearch = university.title.toLowerCase().includes(searchQuery);

            return matchesType && matchesState && matchesAcceptance && matchesInCost && matchesOutCost && matchesSearch;
        });

        displayUniversities(filteredUniversities);
    }


    // Event listener for GPA filter
    document.getElementById('type').addEventListener('change', filterUniversities);
    document.getElementById('state').addEventListener('change', filterUniversities);
    document.getElementById('acceptance').addEventListener('change', filterUniversities);
    document.getElementById('is_cost').addEventListener('change', filterUniversities);
    document.getElementById('os_cost').addEventListener('change', filterUniversities);
    document.querySelector('.search-bar').addEventListener('input', filterUniversities);

    loadUniversity();
</script>


<%- include("partials/footer"); %>